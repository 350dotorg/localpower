{% extends "base/nav_9c.html" %}

{% load dated_static %}
{% load search_widget %}

{% block title %}Events on Repower at Home{% endblock %}
{% block title_bar_image %}<img src="{% dated_static "images/theme_new/section_events_large.png" %}" alt="Events section" height="100" width="100"/>{% endblock %}
{% block title_bar_title %}Events{% endblock %}
{% block title_bar_copy %}
    Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh
    euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
{% endblock %}
{% block ribbon_bar %}Showing {{map_events|length}} events{% endblock %}
{% block content %}
<h1>Host an energy meeting</h1>
<div id="events_map" style="width:100%; height:300px; border: 1px solid; margin-bottom:18px;"></div>
<p>
    Energy meetings bring together people who are already part of a community, like parents in a PTA,
    parishioners in a church, or people in a book club. <b>The meetings bring the idea of saving energy to this
    community</b>, and get members excited about taking action to reduce their use.
</p>
{% search_widget event_search %}

{% if events %}
    <h3>Upcoming Events</h3>
    {% include "events/_event_nugget_list.html" %}
{% endif %}

<script>
    var RAH = RAH || {};
    RAH.pagescripts = RAH.pagescripts || [];
    RAH.pagescripts.push("{% dated_static 'js/pages/events.show.js' %}");
    
    // Add locations for plotting on the map
    RAH.event_locations = [];
    {% for event in map_events %}
        var info = "<b>{{ event.title|escape|escapejs }}</b><br/>\
            {{ event.where|escape|escapejs }}<br/>";
            info += "<a href='{% url event-detail event.id %}'>View event</a>";
        RAH.event_locations.push({ 
            lat: "{{ event.lat }}", 
            lon: "{{ event.lon }}",
            "info": info,
            id: {{ event.id }}
        });
    {% endfor %}
</script>
{% endblock %}

{% block extrajs %}
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
{% endblock %}
